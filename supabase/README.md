# Supabase ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ê°€ì´ë“œ

ì´ í´ë”ì—ëŠ” Supabase ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ë“¤ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ğŸ“‹ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìˆœì„œ

1. `01_create_learning_items.sql` - í•™ìŠµ í•­ëª© í…Œì´ë¸”
2. `02_create_user_progress.sql` - ì‚¬ìš©ì ì§„ë„ í…Œì´ë¸” (SRS í•µì‹¬)
3. `03_create_study_sessions.sql` - í•™ìŠµ ì„¸ì…˜ ê¸°ë¡
4. `04_create_user_stats.sql` - ì‚¬ìš©ì í†µê³„ (ê²Œì„í™”)
5. `05_create_user_badges.sql` - ë°°ì§€ ì‹œìŠ¤í…œ
6. `06_setup_rls.sql` - Row Level Security ì •ì±…

## ğŸš€ ì„¤ì • ë°©ë²•

### Step 1: Supabase í”„ë¡œì íŠ¸ ìƒì„±

1. https://supabase.com ì ‘ì†
2. "New Project" í´ë¦­
3. í”„ë¡œì íŠ¸ ì •ë³´ ì…ë ¥:
   - Name: `japanese-learning-app`
   - Database Password: ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ (ì €ì¥ í•„ìˆ˜!)
   - Region: `Northeast Asia (Seoul)`
4. í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ ëŒ€ê¸° (ì•½ 2ë¶„)

### Step 2: API ì •ë³´ ë³µì‚¬

1. í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œ â†’ Settings â†’ APIë¡œ ì´ë™
2. ë‹¤ìŒ ì •ë³´ ë³µì‚¬:
   - `Project URL` (ì˜ˆ: https://xxxxx.supabase.co)
   - `anon public` Key

### Step 3: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `.env.local` íŒŒì¼ì„ ì—´ê³  ë³µì‚¬í•œ ì •ë³´ ì…ë ¥:

```bash
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

### Step 4: SQL ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰

Supabase ëŒ€ì‹œë³´ë“œì—ì„œ:

1. **SQL Editor** ë©”ë‰´ë¡œ ì´ë™
2. "New query" í´ë¦­
3. ê° ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì˜ ë‚´ìš©ì„ **ìˆœì„œëŒ€ë¡œ** ë³µì‚¬í•´ì„œ ì‹¤í–‰:

#### ì‹¤í–‰ ìˆœì„œ:
```
01_create_learning_items.sql ì‹¤í–‰ â†’ Run
02_create_user_progress.sql ì‹¤í–‰ â†’ Run
03_create_study_sessions.sql ì‹¤í–‰ â†’ Run
04_create_user_stats.sql ì‹¤í–‰ â†’ Run
05_create_user_badges.sql ì‹¤í–‰ â†’ Run
06_setup_rls.sql ì‹¤í–‰ â†’ Run
```

### Step 5: í…Œì´ë¸” í™•ì¸

1. **Table Editor** ë©”ë‰´ë¡œ ì´ë™
2. ë‹¤ìŒ í…Œì´ë¸”ë“¤ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸:
   - âœ… learning_items
   - âœ… user_progress
   - âœ… study_sessions
   - âœ… user_stats
   - âœ… user_badges
   - âœ… badge_definitions

### Step 6: RLS ì •ì±… í™•ì¸

1. **Authentication** â†’ **Policies** ë¡œ ì´ë™
2. ê° í…Œì´ë¸”ì— RLS ì •ì±…ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### í•µì‹¬ í…Œì´ë¸”

#### learning_items (í•™ìŠµ ì½˜í…ì¸ )
- íˆë¼ê°€ë‚˜, ê°€íƒ€ì¹´ë‚˜, ë‹¨ì–´, ë¬¸ë²•, í•œì ì €ì¥
- JLPT ë ˆë²¨ë³„ ë¶„ë¥˜
- ëª¨ë“  ì‚¬ìš©ìê°€ ì½ê¸° ê°€ëŠ¥ (RLS)

#### user_progress (SRS ì§„ë„ ì¶”ì )
- ê° ì‚¬ìš©ìì˜ ê° í•­ëª©ë³„ í•™ìŠµ ì§„ë„
- SRS ì•Œê³ ë¦¬ì¦˜ íŒŒë¼ë¯¸í„° (ease_factor, interval, repetitions)
- ë³µìŠµ ìŠ¤ì¼€ì¤„ (next_review_at)
- ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥ (RLS)

#### study_sessions (í•™ìŠµ ê¸°ë¡)
- ì¼ì¼ í•™ìŠµ ì„¸ì…˜ í†µê³„
- ìŠ¤íŠ¸ë¦­ ê³„ì‚°ì— ì‚¬ìš©
- ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥ (RLS)

#### user_stats (ê²Œì„í™” í†µê³„)
- ë ˆë²¨, XP, ìŠ¤íŠ¸ë¦­
- ëˆ„ì  í•™ìŠµ í†µê³„
- ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥ (RLS)

#### user_badges (ë°°ì§€)
- íšë“í•œ ë°°ì§€ ê¸°ë¡
- badge_definitionsì™€ ì—°ê²°
- ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥ (RLS)

### ìœ ìš©í•œ í•¨ìˆ˜

#### add_user_xp(user_id, xp_amount)
- XP ì¶”ê°€ ë° ìë™ ë ˆë²¨ì—…
- ë°˜í™˜: ìƒˆ ë ˆë²¨, ì´ XP, ë ˆë²¨ì—… ì—¬ë¶€

#### update_user_streak(user_id, study_date)
- ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸
- ë°˜í™˜: í˜„ì¬ ìŠ¤íŠ¸ë¦­, ìµœì¥ ìŠ¤íŠ¸ë¦­, ëŠê¹€ ì—¬ë¶€

#### check_and_award_badges(user_id)
- ë°°ì§€ íšë“ ì¡°ê±´ ìë™ í™•ì¸ ë° ë¶€ì—¬
- ë°˜í™˜: ìƒˆë¡œ íšë“í•œ ë°°ì§€ ëª©ë¡

### ìœ ìš©í•œ ë·°

#### due_reviews
- ì˜¤ëŠ˜ ë³µìŠµí•  í•­ëª© ëª©ë¡
- `next_review_at <= NOW()` ì¡°ê±´

#### user_progress_stats
- ì‚¬ìš©ìë³„ ì§„ë„ í†µê³„
- new/learning/reviewing/mastered ê°œìˆ˜

#### daily_study_stats
- ì¼ì¼ í•™ìŠµ í†µê³„
- ì •ë‹µë¥ , XP ë“±

#### weekly_study_stats
- ì£¼ê°„ í•™ìŠµ í†µê³„
- ì£¼ë³„ í•™ìŠµ ì¼ìˆ˜, ì´ XP

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨ ì‹œ
1. ëª¨ë“  í…Œì´ë¸” ì‚­ì œ í›„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹¤í–‰
2. SQL Editorì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
3. ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í–ˆëŠ”ì§€ í™•ì¸

### RLS ì •ì±… ë¬¸ì œ ì‹œ
1. Authentication â†’ Policiesì—ì„œ ì •ì±… í™•ì¸
2. ê° í…Œì´ë¸”ì— ì •ì±…ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
3. í•„ìš” ì‹œ `06_setup_rls.sql` ì¬ì‹¤í–‰

### ì—°ê²° ë¬¸ì œ ì‹œ
1. `.env.local` íŒŒì¼ì˜ URLê³¼ Key í™•ì¸
2. í”„ë¡œì íŠ¸ê°€ í™œì„±í™” ìƒíƒœì¸ì§€ í™•ì¸
3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. âœ… Supabase ì„¤ì • ì™„ë£Œ
2. â³ í•™ìŠµ ë°ì´í„° ì¤€ë¹„ (íˆë¼ê°€ë‚˜ 46ì)
3. â³ í”„ë¡ íŠ¸ì—”ë“œ UI ê°œë°œ
4. â³ SRS ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„

---

**ì‘ì„±ì¼**: 2025-10-19
**ë²„ì „**: 1.0.0
